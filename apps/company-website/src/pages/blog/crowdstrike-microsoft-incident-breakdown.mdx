import blogHeader from "../../content/images/blogs/stop-bikeshedding.png?preset=responsive";
import BlogLayout from "../../Layouts/BlogLayout";
import ContentTable from "../../components/Blog/ContentTable";
import ResponsiveImage from "../../components/ResponsiveImage";
import bsod from "../../content/images/blogs/crowdstrike-microsoft-incident-breakdown/bsod.png?preset=responsive";

export const meta = {
  id: "crowdstrike-microsoft-incident-breakdown",
  title:
    "Crowdstrike and Microsoft Incident",
  description:
    'CrowdStrike\'s Falcon Sensor update caused "blue screens of death" on millions of Windows systems. The whole incident due to a NULL pointer dereference in C++ code.',
  category: "After work talks",
  image: blogHeader,
  date: 1721473493000,
  updatedAt: 1721473493000,
  author: "davidabram",
  editor: "velimirujevic",
  abstract: "On July 19, 2024, CrowdStrike's Falcon Sensor update caused widespread disruptions on millions of Windows systems, leading to \"blue screens of death\" and boot loops. The issue, a NULL pointer dereference in the C++ code of a system driver, impacted aviation, media, banking, and healthcare sectors, grounding flights and disrupting emergency services. This incident highlights a failure in CrowdStrike's development and deployment processes, as such errors should be caught by automated code sanitization tools. It underscores the importance of rigorous testing, CI/CD practices, and phased rollouts to prevent widespread disruptions in critical systems. Robust testing and deployment strategies are essential, even with memory-safe programming languages.",
  pageType: "blog-posting"
};


Yesterday, on July 19, 2024, CrowdStrike released a critical update for their Falcon Sensor vulnerability scanner, which led to widespread disruptions across millions of Microsoft Windows systems.

This update caused numerous Windows machines to experience "blue screens of death" and enter a boot loop. The incident affected almost every sector, including aviation, media, banking, and healthcare, grounding commercial flights, and disrupting emergency services.

### Technical Issue

The main technical issue in this incident is a [NULL pointer dereference](https://cwe.mitre.org/data/definitions/476.html) in the C++ code. A NULL pointer is a pointer that doesn't point to any valid memory address. When the program tries to dereference this pointer, it accesses invalid memory (location 0x0), causing a crash.

<ResponsiveImage src={bsod} alt="screenshot of a Windows Blue Screen of Death (BSOD) error" />

<br />

In this case, the faulty code attempted to read from memory address 0x9C, an invalid and protected memory region. This problem occurred in a system driver, which has privileged access to the computerâ€™s resources. As a result, the operating system, out of an abundance of caution, crashed immediately to prevent potential damage, resulting in the BSOD.

Null pointer dereference errors are one of the most common mistakes when coding in C++. Usually, errors like this are caught by automated code sanitization tools. These tools detect and fix common coding errors during development, providing immediate feedback to developers and helping them catch errors early and thoroughly analyze the code.

That's why it is so strange to see this kind of error pushed to production, especially in a system driver.

### Opinion: The Importance of Testing and Deployment Practices

This doesn't seem like a problem of a single developer writing faulty code but rather a failure of all guardrails and safety nets provided by CI/CD, review processes, automated tools, testing, and deployment strategies.

Many developers have pointed out and criticized the software development department in CrowdStrike for not catching this issue with tests before deploying the update. While testing is crucial in any codebase, no system catches 100% of bugs, and they can slip through even the most rigorous testing.

Critical updates should be rolled out slowly as a "canary," starting with a small random sample of users. If the update causes issues in this initial phase, the rollout should be stopped immediately to prevent a broader impact. Such a phased approach has been a standard practice for decades and is crucial for mitigating risks associated with software updates.

The lack of guardrails and safety nets for your developers and butchering the whole deployment process is embarrassing.

### Conclusion

This incident didn't happen because of a single developer's mistake and certainly didn't happen because of using a non-memory-safe language like C++. Memory-safe programming languages like Rust can save you from NULL pointer dereference errors, but they can't compensate for poor testing and deployment strategies. This incident was a systematic failure at every layer of the company, which allowed a critical bug to slip through and cause widespread disruptions.

At least the fact that CrowdStrike succeeded where Y2K failed is somewhat impressive.


export default (props) => <BlogLayout meta={meta} {...props}>{props.children}</BlogLayout>;
