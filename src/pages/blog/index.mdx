import Layout from "../../components/Layout";
import { getAllBlogPostMeta } from "../../lib/blogs";
import MostRecent from "../../components/Blog/MostRecent";
import Header from "../../components/Blog/Header";
import Section from "../../components/Layout/Section";
import { BlogJSONLDHead } from "../../components/JSONLD/BlogJSONLDHead";
// TODO: Remove - import { useRouter } from "next/router";

export async function getStaticProps(context) {
  const result = await getAllBlogPostMeta();
  const [featured, ...rest] = result.sort(
    (a, b) => new Date(b.date) - new Date(a.date)
  );
  return {
    props: { featured, rest }, // will be passed to the page component as props
  };
}

export const meta = {
  title: "Blog",
  description:
    "Tips and ideas to help you learn, build and improve your projects.",
};

<Header />
<Section as="main">
  <MostRecent featuredPost={props.featured} posts={props.rest} />
</Section>

export default ({ children }) => {
  const router = useRouter();
  return (
    <Layout
      stickyFooter
      meta={meta}
      slug={router?.pathname}
      title={meta.title}
      description={meta.description}
    >
      <BlogJSONLDHead description={meta.description} />
      {children}
    </Layout>
  );
};
